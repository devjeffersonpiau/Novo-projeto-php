cat > /opt/bolsa-php/nginx.conf <<'NGINX'
server {
  listen 80;
  server_name _;

  # Página inicial -> index.php no PHP-FPM
  location = / {
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME /var/www/html/index.php;
    fastcgi_param QUERY_STRING $query_string;
    fastcgi_pass php:9000;
  }

  # Endpoint da API -> api.php no PHP-FPM
  location ^~ /api/ {
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME /var/www/html/api.php;
    fastcgi_param QUERY_STRING $query_string;
    fastcgi_pass php:9000;
  }

  # Qualquer .php explícito
  location ~ \.php$ {
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name;
    fastcgi_param QUERY_STRING $query_string;
    fastcgi_pass php:9000;
  }
}
NGINX